{"version":3,"sources":["../../../build/src/app/toolbar/toolbar.component.ts"],"names":[],"mappings":"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","file":"toolbar.component.js","sourceRoot":"","sourcesContent":["import {\n  Component,\n  DoCheck,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  TemplateRef,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport { cloneDeep, defaults, find, isEqual, remove } from 'lodash';\n\nimport { Action } from '../action/action';\nimport { Filter } from '../filter/filter';\nimport { FilterFieldsComponent } from '../filter/filter-fields.component';\nimport { FilterEvent } from '../filter/filter-event';\nimport { SortEvent } from '../sort/sort-event';\nimport { ToolbarConfig } from './toolbar-config';\nimport { ToolbarView } from './toolbar-view';\n\n/**\n * Toolbar component\n *\n * Usage:\n * <code><pre>\n * // Individual module import\n * import { ToolbarModule } from 'patternfly-ng/toolbar';\n * // Or\n * import { ToolbarModule } from 'patternfly-ng';\n *\n * // NGX Bootstrap\n * import { BsDropdownConfig, BsDropdownModule } from 'ngx-bootstrap/dropdown';\n *\n * &#64;NgModule({\n *   imports: [BsDropdownModule.forRoot(), ToolbarModule,...],\n *   providers: [BsDropdownConfig]\n * })\n * export class AppModule(){}\n * </pre></code>\n *\n * Optional:\n * <code><pre>\n * import { ToolbarConfig, ToolbarView } from 'patternfly-ng/toolbar';\n * </pre></code>\n */\n\nexport class ToolbarComponent implements DoCheck, OnInit {\n  /**\n   * The toolbar config containing component properties\n   */\n   config: ToolbarConfig;\n\n  /**\n   * The name of the template containing actions\n   */\n   actionTemplate: TemplateRef<any>;\n\n  /**\n   * The name of the template containing views\n   */\n   viewTemplate: TemplateRef<any>;\n\n  /**\n   * The event emitted when an action (e.g., button, kebab, etc.) has been selected\n   */\n   onActionSelect = new EventEmitter();\n\n  /**\n   * The event emitted when a field menu option is selected\n   */\n   onFilterFieldSelect = new EventEmitter();\n\n  /**\n   * The event emitted when a filter has been changed\n   */\n   onFilterChange = new EventEmitter();\n\n  /**\n   * The event emitted when a filter has been saved\n   */\n   onFilterSave = new EventEmitter();\n\n  /**\n   * The event emitted when the user types ahead in the query input field\n   */\n   onFilterTypeAhead = new EventEmitter();\n\n  /**\n   * The event emitted when the sort has changed\n   */\n   onSortChange = new EventEmitter();\n\n  /**\n   * The event emitted when a view has been selected\n   */\n   onViewSelect = new EventEmitter();\n\n   private filterFields: FilterFieldsComponent;\n\n  private defaultConfig: ToolbarConfig = {\n    disabled: false\n  } as ToolbarConfig;\n  private prevConfig: ToolbarConfig;\n\n  /**\n   * The default constructor\n   */\n  constructor() {\n  }\n\n  // Initialization\n\n  /**\n   * Setup component configuration upon initialization\n   */\n  ngOnInit(): void {\n    this.setupConfig();\n  }\n\n  /**\n   * Check if the component config has changed\n   */\n  ngDoCheck(): void {\n    // Do a deep compare on config\n    if (!isEqual(this.config, this.prevConfig)) {\n      this.setupConfig();\n    }\n  }\n\n  /**\n   * Set up default config\n   */\n  protected setupConfig(): void {\n    if (this.config !== undefined) {\n      defaults(this.config, this.defaultConfig);\n    } else {\n      this.config = cloneDeep(this.defaultConfig);\n    }\n\n    if (this.config && this.config.filterConfig) {\n      this.config.filterConfig.disabled = this.config.disabled;\n      if (this.config.filterConfig.appliedFilters === undefined) {\n        this.config.filterConfig.appliedFilters = [];\n      }\n    }\n    if (this.config && this.config.sortConfig) {\n      this.config.sortConfig.disabled = this.config.disabled;\n      if (this.config.sortConfig.fields === undefined) {\n        this.config.sortConfig.fields = [];\n      }\n    }\n    if (this.config.sortConfig !== undefined && this.config.sortConfig.visible === undefined) {\n      this.config.sortConfig.visible = true;\n    }\n    if (this.config && this.config.views === undefined) {\n      this.config.views = [];\n    }\n    if (this.config && this.config.view === undefined) {\n      this.config.view = this.config.views[0];\n    }\n    this.prevConfig = cloneDeep(this.config);\n  }\n\n  // Actions\n\n  /**\n   * Handle clear filter event\n   *\n   * @param $event An array of current Filter objects\n   */\n  clearFilter($event: Filter[]): void {\n    this.config.filterConfig.appliedFilters = $event;\n    this.onFilterChange.emit({\n      appliedFilters: $event\n    } as FilterEvent);\n  }\n\n  /**\n   * Reset current field and value\n   */\n  resetFilterField() {\n    if (this.filterFields !== undefined) {\n      this.filterFields.reset();\n    }\n  }\n\n  // Private\n\n  private filterAdded($event: FilterEvent): void {\n    let newFilter = {\n      field: $event.field,\n      query: $event.query,\n      value: $event.value\n    } as Filter;\n\n    if (!this.filterExists(newFilter)) {\n      if (newFilter.field.type === 'select') {\n        this.enforceSingleSelect(newFilter);\n      }\n      this.config.filterConfig.appliedFilters.push(newFilter);\n      $event.appliedFilters = this.config.filterConfig.appliedFilters;\n      this.onFilterChange.emit($event);\n    }\n  }\n\n  private filterExists(filter: Filter): boolean {\n    let foundFilter = find(this.config.filterConfig.appliedFilters, {\n      field: filter.field,\n      query: filter.query,\n      value: filter.value\n    });\n    return foundFilter !== undefined;\n  }\n\n  private handleAction(action: Action): void {\n    if (action && action.disabled !== true) {\n      this.onActionSelect.emit(action);\n    }\n  }\n\n  private handleFilterFieldSelect($event: FilterEvent): void {\n    this.onFilterFieldSelect.emit($event);\n  }\n\n  private handleFilterSave($event: FilterEvent) {\n    this.onFilterSave.emit($event);\n  }\n\n  private handleFilterTypeAhead($event: FilterEvent) {\n    this.onFilterTypeAhead.emit($event);\n  }\n\n  private sortChange($event: SortEvent): void {\n    this.onSortChange.emit($event);\n  }\n\n  private isViewSelected(currentView: ToolbarView): boolean {\n    return this.config.view && this.config.view.id === currentView.id;\n  }\n\n  private viewSelected(currentView: ToolbarView): void {\n    this.config.view = currentView;\n    if (!currentView.disabled) {\n      this.onViewSelect.emit(currentView);\n    }\n  }\n\n  // Utils\n\n  private enforceSingleSelect(filter: Filter): void {\n    const filterField = { title: filter.field.title };\n    remove(this.config.filterConfig.appliedFilters, { field: filterField });\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  encapsulation: ViewEncapsulation.None,\n  selector: 'pfng-toolbar',\n  template: `<div class=\"row toolbar-pf\"><div class=\"col-sm-12\"><form class=\"toolbar-pf-actions\" [ngClass]=\"{'no-filter-results': config.filterConfig?.resultsCount === 0 && config.filterConfig?.appliedFilters?.length !== 0}\" (submit)=\"$event.preventDefault()\"><div class=\"form-group toolbar-apf-filter\"><pfng-filter-fields [config]=\"config.filterConfig\" #filterFields (onAdd)=\"filterAdded($event)\" (onFieldSelect)=\"handleFilterFieldSelect($event)\" (onSave)=\"handleFilterSave($event)\" (onTypeAhead)=\"handleFilterTypeAhead($event)\" *ngIf=\"config.filterConfig?.fields\"></pfng-filter-fields></div><div class=\"form-group\" *ngIf=\"config.sortConfig?.fields && config.sortConfig?.visible !== false\"><pfng-sort [config]=\"config.sortConfig\" (onChange)=\"sortChange($event)\"></pfng-sort></div><div class=\"form-group toolbar-actions\" *ngIf=\"config.actionConfig !== undefined || actionTemplate !== undefined\"><pfng-action [config]=\"config.actionConfig\" [template]=\"actionTemplate\" (onActionSelect)=\"handleAction($event)\"></pfng-action></div><div class=\"toolbar-pf-action-right\"><div class=\"form-group toolbar-pf-view-selector\" *ngIf=\"viewTemplate !== undefined || (config.views)\"><ng-template [ngTemplateOutlet]=\"viewTemplate\" [ngTemplateOutletContext]=\"{}\"></ng-template><span *ngIf=\"config.views\"><button *ngFor=\"let view of config.views\" class=\"btn btn-link\" [ngClass]=\"{'active': isViewSelected(view), 'disabled': view.disabled === true}\" [attr.aria-label]=\"view.ariaLabel || view.tooltip\" title=\"{{view.tooltip}}\" (click)=\"viewSelected(view)\"><i class=\"{{view.iconStyleClass}}\"></i></button></span></div></div></form><pfng-filter-results [config]=\"config.filterConfig\" (onClear)=\"clearFilter($event)\"></pfng-filter-results></div></div>`\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'config': [{ type: Input },],\n'actionTemplate': [{ type: Input },],\n'viewTemplate': [{ type: Input },],\n'onActionSelect': [{ type: Output, args: ['onActionSelect', ] },],\n'onFilterFieldSelect': [{ type: Output, args: ['onFilterFieldSelect', ] },],\n'onFilterChange': [{ type: Output, args: ['onFilterChange', ] },],\n'onFilterSave': [{ type: Output, args: ['onFilterSave', ] },],\n'onFilterTypeAhead': [{ type: Output, args: ['onFilterTypeAhead', ] },],\n'onSortChange': [{ type: Output, args: ['onSortChange', ] },],\n'onViewSelect': [{ type: Output, args: ['onViewSelect', ] },],\n'filterFields': [{ type: ViewChild, args: ['filterFields', ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}